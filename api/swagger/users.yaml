paths:
  /user/login:
    post:
      summary: Connexion utilisateur
      tags: [Users]
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
      responses:
        200:
          description: Connexion réussie
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        400:
          description: Champs requis manquants
        401:
          description: Identifiants invalides

  /user/refresh:
    post:
      summary: Rafraîchir le token d'accès
      description: Génère un nouveau access token en utilisant le refresh token stocké dans le cookie
      tags: [Users]
      security: []
      responses:
        200:
          description: Nouveau token d'accès généré
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RefreshTokenResponse'
        401:
          description: Refresh token invalide ou manquant
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /user/logout:
    post:
      summary: Déconnexion utilisateur
      description: Supprime les cookies de session
      tags: [Users]
      security:
        - bearerAuth: []
      responses:
        200:
          description: Déconnexion réussie
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Logged out
        401:
          description: Non autorisé
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /user:
    get:
      summary: Récupérer mon profil
      tags: [Users]
      security:
        - bearerAuth: []
      responses:
        200:
          description: Profil utilisateur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        401:
          description: Non autorisé
        500:
          description: Erreur serveur

    put:
      summary: Mettre à jour mon profil
      tags: [Users]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      responses:
        200:
          description: Profil mis à jour
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        401:
          description: Non autorisé
        500:
          description: Erreur serveur

    delete:
      summary: Supprimer mon compte
      tags: [Users]
      security:
        - bearerAuth: []
      responses:
        200:
          description: Compte supprimé
        401:
          description: Non autorisé
        500:
          description: Erreur serveur

  /users:
    get:
      summary: Récupérer tous les utilisateurs
      tags: [Users]
      security:
        - bearerAuth: []
      responses:
        200:
          description: Liste des utilisateurs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/User'
        401:
          description: Non autorisé
        500:
          description: Erreur serveur

    post:
      summary: Créer un nouvel utilisateur (Admin uniquement)
      tags: [Users]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
      responses:
        200:
          description: Utilisateur créé
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        400:
          description: Champs requis manquants
        401:
          description: Non autorisé
        403:
          description: Accès refusé (admin requis)
        500:
          description: Erreur serveur

  /users/{id}:
    get:
      summary: Récupérer un utilisateur par ID
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
      responses:
        200:
          description: Utilisateur trouvé
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        401:
          description: Non autorisé
        500:
          description: Erreur serveur

    put:
      summary: Mettre à jour un utilisateur (Admin uniquement)
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      responses:
        200:
          description: Utilisateur mis à jour
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'
        401:
          description: Non autorisé
        403:
          description: Accès refusé (admin requis)
        500:
          description: Erreur serveur

    delete:
      summary: Supprimer un utilisateur (Admin uniquement)
      tags: [Users]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
      responses:
        200:
          description: Utilisateur supprimé
        401:
          description: Non autorisé
        403:
          description: Accès refusé (admin requis)
        500:
          description: Erreur serveur

