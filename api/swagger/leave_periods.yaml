paths:
  /user/leave-periods:
    get:
      summary: Récupérer mes périodes de congé
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      responses:
        200:
          description: Liste des périodes de congé
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeavePeriod'
        401:
          description: Non autorisé
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Créer une période de congé pour moi-même
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLeavePeriodRequest'
      responses:
        201:
          description: Période de congé créée
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeavePeriod'
        400:
          description: Données invalides
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        401:
          description: Non autorisé
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /user/leave-periods/{id}:
    delete:
      summary: Supprimer ma période de congé
      description: Seules les périodes non acceptées peuvent être supprimées par l'utilisateur
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la période de congé
      responses:
        200:
          description: Période de congé supprimée
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Leave period deleted
        400:
          description: Impossible de supprimer une période acceptée
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        401:
          description: Non autorisé
        404:
          description: Période de congé non trouvée
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users/{id}/leave-periods:
    get:
      summary: Récupérer les périodes de congé d'un utilisateur
      description: Accessible aux managers de l'équipe et aux administrateurs
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
      responses:
        200:
          description: Liste des périodes de congé
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LeavePeriod'
        401:
          description: Non autorisé
        403:
          description: Accès interdit (non manager/admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        404:
          description: Utilisateur non trouvé
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Créer une période de congé pour un utilisateur
      description: Accessible aux managers de l'équipe et aux administrateurs
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateLeavePeriodRequest'
      responses:
        201:
          description: Période de congé créée
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeavePeriod'
        400:
          description: Données invalides
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        401:
          description: Non autorisé
        403:
          description: Accès interdit (non manager/admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        404:
          description: Utilisateur non trouvé
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /users/{user_id}/leave-periods/{leave_id}:
    put:
      summary: Accepter ou rejeter une période de congé
      description: Accessible aux managers de l'équipe et aux administrateurs
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
        - name: leave_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la période de congé
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateLeavePeriodRequest'
      responses:
        200:
          description: Période de congé mise à jour
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeavePeriod'
        400:
          description: Données invalides
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        401:
          description: Non autorisé
        403:
          description: Accès interdit (non manager/admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        404:
          description: Période de congé non trouvée
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      summary: Supprimer une période de congé d'un utilisateur
      description: Accessible aux managers de l'équipe et aux administrateurs
      tags: [Leave Periods]
      security:
        - bearerAuth: []
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de l'utilisateur
        - name: leave_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID de la période de congé
      responses:
        200:
          description: Période de congé supprimée
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Leave period deleted
        401:
          description: Non autorisé
        403:
          description: Accès interdit (non manager/admin)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        404:
          description: Période de congé non trouvée
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        500:
          description: Erreur serveur
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
